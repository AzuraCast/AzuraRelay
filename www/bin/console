#!/usr/bin/env php
<?php
error_reporting(E_ALL & ~E_NOTICE & ~E_STRICT);
ini_set('display_errors', 1);

$autoloader = require dirname(__DIR__).'/vendor/autoload.php';

$app = \Azura\App::create([
    'autoloader' => $autoloader,
    'settings' => [
        \Azura\Settings::BASE_DIR => dirname(__DIR__),
        \Azura\Settings::IS_DOCKER => true,
    ],
]);

$di = $app->getContainer();

/** @var \Doctrine\ORM\EntityManager $em */
$em = $di[\Doctrine\ORM\EntityManager::class];

/** @var \Azura\Settings $settings */
$settings = $di[\Azura\Settings::class];

$helperSet = \Doctrine\ORM\Tools\Console\ConsoleRunner::createHelperSet($em);
$helperSet->set(new \Symfony\Component\Console\Helper\QuestionHelper, 'dialog');

$cli = new \Azura\Console\Application('AzuraRelay CLI ('.$settings[\Azura\Settings::APP_ENV].')');
$cli->setContainer($di);
$cli->setHelperSet($helperSet);

$cli->run();
